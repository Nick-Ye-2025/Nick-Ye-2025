import requests
Pinglun=''
cursor=0
while True:
    wz={'user-agent':'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/94.0.4606.71 Safari/537.36 Core/1.94.244.400 QQBrowser/12.5.5646.400',
    'referer':'https://www.douyin.com/user/self?modal_id=7368877502024011018&showTab=record',
    'cookie':'LOGIN_STATUS=1; xgplayer_user_id=593412328556; ttwid=1%7C8NL5uoyEam098YjQkt5g-yBvVZRWcXSAH2LqzRTyDkw%7C1715699810%7C8086f42fb0a40b1ba02ac1246ea988826eb20f7162802060880a84180e09ad96; s_v_web_id=verify_lw6jdb3n_KqZFhXKE_psXd_4tDI_9fFq_sw7Fd3LDNEHh; passport_csrf_token=50bc0ef722bd9385687a095c910fea2c; passport_csrf_token_default=50bc0ef722bd9385687a095c910fea2c; bd_ticket_guard_client_web_domain=2; SEARCH_RESULT_LIST_TYPE=%22single%22; live_use_vvc=%22false%22; dy_sheight=720; dy_swidth=1280; download_guide=%223%2F20240522%2F0%22; d_ticket=0a2c43f5eaaaadfa9cb7b69bed83a3bf1ce78; n_mh=bD10ucMYZy41wTPBBodyBC2hFhdhxmhixr-S8JXyzuc; passport_auth_status=b500d96f1f9e6d9143ac15452a6a188c%2C; passport_auth_status_ss=b500d96f1f9e6d9143ac15452a6a188c%2C; publish_badge_show_info=%220%2C0%2C0%2C1716384801496%22; _bd_ticket_crypt_doamin=2; __security_server_data_status=1; __live_version__=%221.1.2.250%22; live_can_add_dy_2_desktop=%221%22; my_rd=2; store-region=cn-gd; store-region-src=uid; FORCE_LOGIN=%7B%22videoConsumedRemainSeconds%22%3A180%2C%22isForcePopClose%22%3A1%7D; passport_assist_user=Cjwi2_JVzTSuXRMUL5ZDrUXYkeLUKtzRY5z34sJ8s2CPdhhsXdA5JxxDlG6srozch8F-dZnpou708z323JgaSgo8hPVa-ToU9zWg0nq1QB0E3wYioaClNlcA_kY5k3a_WiKlio7BwWQOOF9N7l-3ma-78Ll84bcsmW5VRnBXEPv90Q0Yia_WVCABIgEDYY7FSQ%3D%3D; sso_uid_tt=b4d568b40973727627112e1f3ba4b9f6; sso_uid_tt_ss=b4d568b40973727627112e1f3ba4b9f6; toutiao_sso_user=c0677126f73bfba093536b60f0137440; toutiao_sso_user_ss=c0677126f73bfba093536b60f0137440; sid_ucp_sso_v1=1.0.0-KGQyNGRlNmY0ZDRjODQ5ZDc3MmYwZGYxMzVkNWQxMDI4OTY0YTcwODIKHwjY9NXQjAIQxIS4sgYY7zEgDDC_m4PPBTgFQPsHSAMaAmxmIiBjMDY3NzEyNmY3M2JmYmEwOTM1MzZiNjBmMDEzNzQ0MA; ssid_ucp_sso_v1=1.0.0-KGQyNGRlNmY0ZDRjODQ5ZDc3MmYwZGYxMzVkNWQxMDI4OTY0YTcwODIKHwjY9NXQjAIQxIS4sgYY7zEgDDC_m4PPBTgFQPsHSAMaAmxmIiBjMDY3NzEyNmY3M2JmYmEwOTM1MzZiNjBmMDEzNzQ0MA; uid_tt=f2a5a1ea05e8b0a8eb2550fcbd1ee627; uid_tt_ss=f2a5a1ea05e8b0a8eb2550fcbd1ee627; sid_tt=cb0c4759b21e9b0281cbac9bc96e0589; sessionid=cb0c4759b21e9b0281cbac9bc96e0589; sessionid_ss=cb0c4759b21e9b0281cbac9bc96e0589; _bd_ticket_crypt_cookie=fcfe47bd261d990fe47c83ee9279135b; sid_guard=cb0c4759b21e9b0281cbac9bc96e0589%7C1716388426%7C5183997%7CSun%2C+21-Jul-2024+14%3A33%3A43+GMT; sid_ucp_v1=1.0.0-KGYzZTVhMzQzOGRmNzQ0YzIxMGY3NzczMjY0OGZkNGU3MmFiODhhM2YKGQjY9NXQjAIQyoS4sgYY7zEgDDgFQPsHSAQaAmhsIiBjYjBjNDc1OWIyMWU5YjAyODFjYmFjOWJjOTZlMDU4OQ; ssid_ucp_v1=1.0.0-KGYzZTVhMzQzOGRmNzQ0YzIxMGY3NzczMjY0OGZkNGU3MmFiODhhM2YKGQjY9NXQjAIQyoS4sgYY7zEgDDgFQPsHSAQaAmhsIiBjYjBjNDc1OWIyMWU5YjAyODFjYmFjOWJjOTZlMDU4OQ; pwa2=%220%7C0%7C3%7C0%22; stream_player_status_params=%22%7B%5C%22is_auto_play%5C%22%3A0%2C%5C%22is_full_screen%5C%22%3A0%2C%5C%22is_full_webscreen%5C%22%3A0%2C%5C%22is_mute%5C%22%3A1%2C%5C%22is_speed%5C%22%3A1%2C%5C%22is_visible%5C%22%3A0%7D%22; douyin.com; xg_device_score=7.621554818806056; device_web_cpu_core=16; device_web_memory_size=8; architecture=amd64; csrf_session_id=f6e2242947ed054e0d3a82ad624f57e5; strategyABtestKey=%221716626728.829%22; passport_fe_beating_status=true; FOLLOW_NUMBER_YELLOW_POINT_INFO=%22MS4wLjABAAAA9LyRGbQYYtE3XUsWZ6pRNEcEG82h4zmXNdQX7dR3x6U%2F1716652800000%2F0%2F0%2F1716653740642%22; __ac_nonce=066520f9f0002137b847; __ac_signature=_02B4Z6wo00f01kmmgNQAAIDDwu0bNnYbuApJhoRAAPRKKX539pWnsfEZruzAeaK5bwNfN1OZmsIk7e-XxJXx5Hz6GWxgYbFGdCpLjXmuu3hfbhMpiLSGJ5coaG4Uk377DgM-rKjGJ2LYrRVkd4; IsDouyinActive=true; stream_recommend_feed_params=%22%7B%5C%22cookie_enabled%5C%22%3Atrue%2C%5C%22screen_width%5C%22%3A1280%2C%5C%22screen_height%5C%22%3A720%2C%5C%22browser_online%5C%22%3Atrue%2C%5C%22cpu_core_num%5C%22%3A16%2C%5C%22device_memory%5C%22%3A8%2C%5C%22downlink%5C%22%3A6.6%2C%5C%22effective_type%5C%22%3A%5C%224g%5C%22%2C%5C%22round_trip_time%5C%22%3A50%7D%22; FOLLOW_LIVE_POINT_INFO=%22MS4wLjABAAAA9LyRGbQYYtE3XUsWZ6pRNEcEG82h4zmXNdQX7dR3x6U%2F1716739200000%2F0%2F1716653986429%2F0%22; bd_ticket_guard_client_data=eyJiZC10aWNrZXQtZ3VhcmQtdmVyc2lvbiI6MiwiYmQtdGlja2V0LWd1YXJkLWl0ZXJhdGlvbi12ZXJzaW9uIjoxLCJiZC10aWNrZXQtZ3VhcmQtcmVlLXB1YmxpYy1rZXkiOiJCTGo1MXFFMTlYMUNwQktZOXJSTG85WGhNZjY5UnhFaWZBaWV0bExtcUw4ZDlWOW10VDRQaDlGa3NydjRMb29OMUorSHc5REl2NWtrbWhUbmFGUnA1djg9IiwiYmQtdGlja2V0LWd1YXJkLXdlYi12ZXJzaW9uIjoxfQ%3D%3D; home_can_add_dy_2_desktop=%221%22; odin_tt=76aec42380a7cc3423e6434876d5b821451940f11a1ed2543b4a70b610d849251488c64cb533f0c95f1f59edc3b971db09b405723b20dda34b9b59a8d98671c6; volume_info=%7B%22isUserMute%22%3Afalse%2C%22isMute%22%3Afalse%2C%22volume%22%3A1%7D; msToken=PgSz4RrSlKA5DTTBCL1EhggPva2gC0alcmVPj24x98AXuqLy07vQMXw4XcLK_Ujn4i5IEdXpBuWe7vzQ1TbzxuW2qebKPlKL39m0Pc3CosWUwmBfSG32_8YTtvoMPG0=',
    'method':'GET',
    'accept':'application/json, text/plain, */*',
    'authority':'www.douyin.com',
    'path':'/aweme/v1/web/comment/list/?device_platform=webapp&aid=6383&channel=channel_pc_web&aweme_id=7368877502024011018&cursor=0&count=20&item_type=0&insert_ids=&whale_cut_token=&cut_version=1&rcFT=&update_version_code=170400&pc_client_type=1&version_code=170400&version_name=17.4.0&cookie_enabled=true&screen_width=1280&screen_height=720&browser_language=zh-CN&browser_platform=Win32&browser_name=QQBrowser&browser_version=12.5.5646.400&browser_online=true&engine_name=Blink&engine_version=94.0.4606.71&os_name=Windows&os_version=10&cpu_core_num=16&device_memory=8&platform=PC&downlink=6.6&effective_type=4g&round_trip_time=50&webid=7368874484311442944&msToken=oP_t7n_IPZ97x81mlNJU5D_1_DX8YUoCJ0J_Erbg5E_-IOZxQMZo_G2-9qdrJWRusKXtWiOS3lb_TKWWJbvxIZvrofFkoYIhcPsxxJ4BS8kglaTfjZ22nZPWh8m7__g%3D&a_bogus=QJ8ZQQgDdE2T6f6X53VLfY3q6IH3Y81C0trEMD2f1Vf8ug39HMTd9exEst4vABbjLG%2FlIeYjy4htTrNMi5d9A3v378DKWIxk-g00tMlDso0j53ine6SmE04P-hsASl-QsvMUEKi8q7IeSYSZlVAJ5kIlO62-zo0%2F9Au%3D&verifyFp=verify_lw6jdb3n_KqZFhXKE_psXd_4tDI_9fFq_sw7Fd3LDNEHh&fp=verify_lw6jdb3n_KqZFhXKE_psXd_4tDI_9fFq_sw7Fd3LDNEHh',
    'Remote Address':'183.61.4.250:443',
    'Referrer Policy':'strict-origin-when-cross-origin'
    }
    url=f'https://www.douyin.com/aweme/v1/web/comment/list/?device_platform=webapp&aid=6383&channel=channel_pc_web&aweme_id=7368877502024011018&cursor={cursor}&count=20&item_type=0&insert_ids=&whale_cut_token=&cut_version=1&rcFT=&update_version_code=170400&pc_client_type=1&version_code=170400&version_name=17.4.0&cookie_enabled=true&screen_width=1280&screen_height=720&browser_language=zh-CN&browser_platform=Win32&browser_name=QQBrowser&browser_version=12.5.5646.400&browser_online=true&engine_name=Blink&engine_version=94.0.4606.71&os_name=Windows&os_version=10&cpu_core_num=16&device_memory=8&platform=PC&downlink=6.6&effective_type=4g&round_trip_time=50&webid=7368874484311442944&msToken=oP_t7n_IPZ97x81mlNJU5D_1_DX8YUoCJ0J_Erbg5E_-IOZxQMZo_G2-9qdrJWRusKXtWiOS3lb_TKWWJbvxIZvrofFkoYIhcPsxxJ4BS8kglaTfjZ22nZPWh8m7__g%3D&a_bogus=QJ8ZQQgDdE2T6f6X53VLfY3q6IH3Y81C0trEMD2f1Vf8ug39HMTd9exEst4vABbjLG%2FlIeYjy4htTrNMi5d9A3v378DKWIxk-g00tMlDso0j53ine6SmE04P-hsASl-QsvMUEKi8q7IeSYSZlVAJ5kIlO62-zo0%2F9Au%3D&verifyFp=verify_lw6jdb3n_KqZFhXKE_psXd_4tDI_9fFq_sw7Fd3LDNEHh&fp=verify_lw6jdb3n_KqZFhXKE_psXd_4tDI_9fFq_sw7Fd3LDNEHh'
    res=requests.get(url,headers=wz)
    JSON=res.json()
    comments=JSON['comments']
    for comment in comments:
        text=comment['text']
        print(text)
        Pinglun += text
        # print(comment['text'])
    if JSON['has_more'] == 0:
        break
    cursor=JSON['cursor']
open('Pinglun.txt','w',encoding='utf-8').write(Pinglun)
import re
from wordcloud import WordCloud
import matplotlib.pyplot
Pinglun=open('Pinglun.txt','r',encoding='utf-8').read()
Pinglun=re.sub(r'\[.*?\]','',Pinglun)  #\反义字符，\[匹配左方括号，\]匹配右方括号
wc=WordCloud(font_path='STHUPO.TTF',width=1920,height=1080,background_color='white').generate(Pinglun) #词云
matplotlib.pyplot.imshow(wc)
matplotlib.pyplot.show()

